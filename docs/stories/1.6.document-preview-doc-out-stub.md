---
title: "Story 1.6: document-preview-doc-out-stub"
---

# Status

Done

# Story

As a non‑tech user,
I want to preview markdown documents and see a doc‑out placeholder,
so that I can validate content before export.

# Acceptance Criteria

1. Preview markdown từ mẫu/tệp giả lập
2. `doc‑out` hiển thị placeholder (sẽ nối BE ở Epic 2)

# Tasks / Subtasks

- [x] Trang Preview (AC: 1)
  - [x] Route `/preview` hiển thị nội dung markdown cơ bản (headings, code, tables) [Source: docs/prd/epic-1-foundation-nontech-guided-shell.md#story-16-document-preview-docout-stub]
  - [x] Dữ liệu stub: render từ `docs/brief.md` [Source: docs/brief.md]
  - [x] A11y: cấu trúc semantics đúng; keyboard navigation; focus management [Source: docs/prd/accessibility.md]
  - [x] i18n: văn bản UI bám ngôn ngữ hiện tại (vi mặc định) [Source: docs/prd/ux-vision.md]
  
- [x] Doc‑out Stub (AC: 2)
  - [x] Nút "Doc out" trên Header; click hiển thị placeholder (toast/modal) chưa nối BE [Source: docs/prd/epic-1-foundation-nontech-guided-shell.md#story-16-document-preview-docout-stub]
  - [x] Không gọi BE; chỉ thông báo trạng thái stub (ví dụ: "doc‑out stub") [Source: docs/prd/functional-fr.md]

- [x] An toàn nội dung
  - [x] Sanitize markdown render; chặn scripts/HTML nguy hiểm; đặc biệt lưu ý mermaid nếu hỗ trợ sau này [Source: docs/prd/additional-assumptions.md]

- [x] Smoke Verification
  - [x] Trang `/preview` render được `docs/brief.md`; cuộn/điều hướng bàn phím hoạt động [Source: docs/prd/testing-requirements.md]
  - [x] Nút "Doc out" hiển thị placeholder; không có lỗi console [Source: docs/prd/testing-requirements.md]

# Dev Notes

- Previous Story Insights
  - Kế thừa i18n (Story 1.2) cho văn bản UI trên trang Preview và thông báo doc‑out.
  - Có thể tái sử dụng pattern dialog/drawer (Story 1.4) nếu chọn hiển thị placeholder bằng modal.

- Data Models
  - No specific guidance found in architecture docs

- API Specifications
  - No specific guidance found in architecture docs

- Component Specifications
  - No specific guidance found in architecture docs

- File Locations
  - No specific guidance found in architecture docs

- Testing Requirements
  - No specific guidance found in architecture docs
  - Tham chiếu yêu cầu kiểm thử: [Source: docs/prd/testing-requirements.md]

- Technical Constraints
  - No specific guidance found in architecture docs
  - Ràng buộc liên quan (PRD): sanitize markdown/mermaid; i18n vi/en; files‑only ở MVP [Source: docs/prd/additional-assumptions.md]

### Project Structure Notes
- Không tìm thấy `docs/architecture/unified-project-structure.md`. Bám `docs/prd/repository-structure.md` (monorepo, giữ `docs/` và `.bmad-core/...`).

## Testing

- Approach: Unit + Integration (UI), lint + type‑check [Source: docs/prd/testing-requirements.md]
- Key scenarios:
  - Render `docs/brief.md` trên `/preview`; navigation bàn phím hoạt động; focus management đúng
  - Click "Doc out" → placeholder hiển thị; không có gọi BE
  - Văn bản UI theo ngôn ngữ hiện tại (vi/en)
- Success criteria:
  - Đáp ứng AC 1–2; smoke test pass; lint/type‑check/build pass

# Change Log

| Date       | Version | Description                                   | Author |
|------------|---------|-----------------------------------------------|--------|
| 2025-08-09 | 0.1     | Khởi tạo bản nháp Story 1.6 (Draft)           | Bob    |
| 2025-08-09 | 0.2     | Implement `/preview`, thêm nút Doc out (stub), sanitize markdown | James |
| 2025-08-09 | 0.3     | Set Status → Ready for Review                 | Sarah  |
| 2025-08-09 | 1.0     | Smoke pass; Set Status → Done                 | Sarah  |

# Dev Agent Record

## Agent Model Used

GPT-5 (@dev)

## Debug Log References

- 2025-08-10: Cài deps `markdown-it`, `sanitize-html`; thêm types; lint/build PASS.
- 2025-08-10: Tạo `/preview` đọc `../docs/brief.md`, render qua `renderMarkdownToHtml()` với sanitize; build PASS.
- 2025-08-10: Khởi chạy `npm start` và truy cập `/preview` → nội dung brief hiển thị đúng, không cảnh báo console.
- 2025-08-10: Thêm nút "Doc out" trong `HeaderControls` hiển thị toast `doc-out stub` khi click.

## Completion Notes List

- AC1: ĐẠT — `/preview` hiển thị markdown cơ bản từ `docs/brief.md` (headings, code, tables).
- AC2: ĐẠT — Nút "Doc out" chỉ hiển thị placeholder (không gọi BE) theo yêu cầu của story 1.6.
- A11y/i18n: Tiêu đề trang dùng i18n (mặc định vi), cấu trúc semantics đúng; keyboard nav cơ bản hoạt động.

## File List

- `web/src/app/preview/page.tsx` (new)
- `web/src/lib/markdown.ts` (new)
- `web/src/components/HeaderControls.tsx` (edited — thêm nút Doc out + toast)
- `web/src/lib/i18n.ts` (edited — thêm keys `docOut`, `docOutStub`, `previewTitle`)
- `web/package.json` (edited — thêm dependencies/typings)

# QA Results

- Lint: pass; Type-check: pass; Build: pass
- Manual smoke:
  - GET `/preview` → hiển thị nội dung từ `docs/brief.md` (đã sanitize)
  - Click nút "Doc out" → hiện toast "Doc-out stub" trong ~2.5s; không có lỗi console
